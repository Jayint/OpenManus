# 项目概述

<cite>
**本文档中引用的文件**  
- [main.py](file://main.py)
- [README.md](file://README.md)
- [manus.py](file://app/agent/manus.py)
- [data_analysis.py](file://app/agent/data_analysis.py)
- [mcp.py](file://app/agent/mcp.py)
- [config.example.toml](file://config/config.example.toml)
- [run_mcp.py](file://run_mcp.py)
- [run_flow.py](file://run_flow.py)
- [planning.py](file://app/flow/planning.py)
- [toolcall.py](file://app/agent/toolcall.py)
</cite>

## 目录
1. [简介](#简介)
2. [核心目标与定位](#核心目标与定位)
3. [主要功能与应用场景](#主要功能与应用场景)
4. [系统架构概览](#系统架构概览)
5. [核心组件分析](#核心组件分析)
6. [启动与使用示例](#启动与使用示例)
7. [与其他AI代理系统的对比](#与其他ai代理系统的对比)
8. [目标用户群体](#目标用户群体)

## 简介

OpenManus 是一个开源的通用AI代理框架，旨在为开发者和研究人员提供一个无需邀请码即可使用的强大工具，以解决多样化任务。该项目由MetaGPT团队成员发起，其设计初衷是构建一个灵活、可扩展且易于使用的AI代理系统。通过集成多种工具和协议，OpenManus能够执行从数据分析到多代理协作的复杂任务。

本项目不仅支持标准的AI代理功能，还特别强调了对MCP（Model Context Protocol）协议的支持，使得用户可以轻松地将外部工具和服务集成到代理的工作流中。此外，OpenManus提供了丰富的配置选项和模块化设计，允许用户根据具体需求定制自己的代理实例。

**Section sources**
- [README.md](file://README.md#L1-L195)

## 核心目标与定位

OpenManus的核心目标是成为一个通用的AI代理框架，它能够适应各种应用场景，并为用户提供一个无需邀请码即可访问的强大工具集。该框架的设计理念是“通用性”和“易用性”，即无论用户需要完成何种类型的任务，都可以通过OpenManus找到合适的解决方案。

作为一款开源项目，OpenManus致力于降低AI技术的应用门槛，让更多的开发者、研究人员以及自动化工程师能够利用先进的AI能力来提升工作效率。同时，它也鼓励社区贡献，不断优化和完善现有功能，推动整个AI代理领域的发展。

**Section sources**
- [README.md](file://README.md#L1-L195)

## 主要功能与应用场景

### 数据分析
OpenManus内置了DataAnalysis Agent，专门用于处理数据分析和数据可视化任务。此代理结合了Python执行、图表准备和数据可视化等工具，能够帮助用户快速生成高质量的数据报告。例如，在`app/tool/chart_visualization/test/chart_demo.py`中的示例展示了如何使用DataAnalysis Agent生成不同类型的图表并保存到本地。

### 多代理协作
通过`run_flow.py`脚本，用户可以启动一个多智能体版本的OpenManus，实现多个代理之间的协同工作。这种模式适用于需要多个专业技能共同完成的任务，如复杂的软件开发流程或跨领域的研究项目。在配置文件`config.toml`中，可以通过设置`[runflow]`部分的`use_data_analysis_agent = true`来激活DataAnalysis Agent。

### MCP协议集成
MCP（Model Context Protocol）协议的集成是OpenManus的一大亮点。通过`run_mcp.py`脚本，用户可以运行一个基于MCP工具版本的代理，该代理能够连接到远程MCP服务器并通过SSE或stdio传输方式调用其提供的工具。这极大地扩展了代理的功能范围，使其能够访问更多外部资源和服务。

**Section sources**
- [data_analysis.py](file://app/agent/data_analysis.py#L1-L37)
- [run_flow.py](file://run_flow.py#L1-L52)
- [mcp.py](file://app/agent/mcp.py#L1-L185)
- [config.example.toml](file://config/config.example.toml#L1-L105)

## 系统架构概览

OpenManus采用模块化设计，各主要组件之间通过清晰的接口进行交互。整体架构包括以下几个关键部分：

- **Agent层**：负责具体的任务执行，如Manus、DataAnalysis等。
- **Flow层**：管理多个代理间的协作流程，如PlanningFlow。
- **Tool层**：提供各种工具供代理调用，如Python执行、浏览器自动化等。
- **Config层**：存储系统配置信息，如LLM参数、MCP服务器地址等。

这些组件共同构成了一个灵活且强大的AI代理框架，支持用户根据实际需求进行定制和扩展。

```mermaid
graph TB
subgraph "Agent Layer"
Manus[Manus Agent]
DataAnalysis[DataAnalysis Agent]
MCPAgent[MCP Agent]
end
subgraph "Flow Layer"
PlanningFlow[Planning Flow]
end
subgraph "Tool Layer"
PythonExecute[Python Execute Tool]
BrowserUse[Browser Use Tool]
StrReplaceEditor[Str Replace Editor]
AskHuman[Ask Human Tool]
Terminate[Terminate Tool]
end
subgraph "Config Layer"
Config[Configuration]
end
Manus --> |Uses| Tool Layer
DataAnalysis --> |Uses| Tool Layer
MCPAgent --> |Connects to| MCP Server
PlanningFlow --> |Orchestrates| Agent Layer
Config --> |Provides settings for| All Layers
```

**Diagram sources**
- [manus.py](file://app/agent/manus.py#L1-L165)
- [data_analysis.py](file://app/agent/data_analysis.py#L1-L37)
- [mcp.py](file://app/agent/mcp.py#L1-L185)
- [planning.py](file://app/flow/planning.py#L1-L442)
- [toolcall.py](file://app/agent/toolcall.py#L1-L250)

## 核心组件分析

### Manus Agent
Manus是OpenManus中最基础也是最重要的代理之一。它继承自ToolCallAgent类，具备执行多种工具的能力，包括Python代码执行、浏览器自动化操作、文件编辑以及向人类求助等。Manus通过`main.py`脚本启动，用户可以在终端输入创意后由代理自动处理请求。

#### 初始化过程
当创建Manus实例时，会调用`create`类方法完成初始化。此过程中，代理会尝试连接配置文件中定义的所有MCP服务器，并将这些服务器上的工具添加到可用工具列表中。如果连接失败，则会在日志中记录错误信息但不会中断整个初始化流程。

#### 工具调用机制
Manus使用`think`方法决定下一步行动。该方法首先检查最近的消息历史记录以确定是否正在使用浏览器工具，如果是，则更新下一步提示内容；然后调用父类的`think`方法生成响应。整个过程确保了代理能够在不同上下文中做出合理决策。

**Section sources**
- [manus.py](file://app/agent/manus.py#L1-L165)
- [main.py](file://main.py#L1-L36)

### DataAnalysis Agent
DataAnalysis Agent专注于解决数据分析相关任务。它同样继承自ToolCallAgent类，但配备了更适合数据处理的工具集，如NormalPythonExecute、VisualizationPrepare和DataVisualization。这些工具使得代理能够高效地执行数据分析、生成图表并撰写报告。

#### 特殊配置
与Manus相比，DataAnalysis Agent具有更高的观察限制（max_observe=15000），这意味着它可以处理更大量的数据输出。此外，它的系统提示和下一步提示都针对数据任务进行了优化，引导代理按照最佳实践进行操作。

**Section sources**
- [data_analysis.py](file://app/agent/data_analysis.py#L1-L37)

### MCP Agent
MCP Agent专为与MCP服务器交互而设计。它支持两种连接类型：SSE和stdio。通过`initialize`方法，代理可以根据指定的连接类型建立与远程服务器的通信，并获取可用工具列表。一旦连接成功，所有来自MCP服务器的工具都将被封装成MCPClientTool对象并加入到代理的工具集合中。

#### 动态工具刷新
为了保证工具列表的实时性，MCP Agent会在每N步（默认为5步）调用`_refresh_tools`方法检查是否有新增、移除或变更的工具。如果有变化，代理会相应地更新内部状态并向用户发送通知消息。

**Section sources**
- [mcp.py](file://app/agent/mcp.py#L1-L185)

## 启动与使用示例

### 标准代理启动
要启动标准的OpenManus代理，只需运行以下命令：
```bash
python main.py
```
随后在终端输入您的创意即可。代理将根据输入内容自动选择合适的工具并执行相应操作。

### MCP工具版本
对于希望使用MCP工具版本的用户，可执行：
```bash
python run_mcp.py
```
此命令将启动一个连接到本地MCP服务器的代理，默认使用stdio连接方式。您也可以通过命令行参数指定其他连接类型或服务器URL。

### 多智能体版本
体验不稳定的多智能体版本，请运行：
```bash
python run_flow.py
```
在此之前，请确保已在`config.toml`中正确配置了所需的代理，如启用DataAnalysis Agent。

**Section sources**
- [main.py](file://main.py#L1-L36)
- [run_mcp.py](file://run_mcp.py#L1-L116)
- [run_flow.py](file://run_flow.py#L1-L52)

## 与其他AI代理系统的对比

相较于其他AI代理系统，OpenManus具备以下优势：

1. **开源免费**：完全开源且无需邀请码，任何人都可以自由使用和贡献代码。
2. **高度可扩展**：通过MCP协议支持外部工具集成，极大增强了系统的功能性。
3. **模块化设计**：各个组件独立开发维护，便于理解和修改。
4. **社区支持**：拥有活跃的社区支持，定期接收来自全球开发者的反馈和改进建议。

尽管存在一些尚不稳定的功能（如多智能体协作），但凭借其开放性和灵活性，OpenManus已成为当前AI代理领域内极具潜力的项目之一。

**Section sources**
- [README.md](file://README.md#L1-L195)

## 目标用户群体

OpenManus主要面向以下几类用户：

- **开发者**：希望通过AI技术提高编程效率，自动化测试或部署流程。
- **研究人员**：需要处理大量实验数据并生成可视化报告的科研人员。
- **自动化工程师**：寻求构建智能自动化系统的专业人士，如RPA开发者。

无论是初学者还是高级用户，OpenManus都能提供足够的灵活性和深度，满足不同层次的需求。对于初学者而言，简单的启动命令和直观的交互界面降低了学习成本；而对于高级用户，则可通过深入定制配置文件和编写自定义工具来充分发挥创造力。

**Section sources**
- [README.md](file://README.md#L1-L195)